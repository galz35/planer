{"numFailedTestSuites":3,"numFailedTests":15,"numPassedTestSuites":4,"numPassedTests":85,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":7,"numTotalTests":100,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1768315271066,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["AppController","root"],"duration":55,"failureDetails":[],"failureMessages":[],"fullName":"AppController root should return \"Hello World!\"","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return \"Hello World!\""}],"endTime":1768315276496,"message":"","name":"D:\\planificacion\\backend\\src\\app.controller.spec.ts","startTime":1768315272288,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["PlanningService"],"duration":55,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should be defined"},{"ancestorTitles":["PlanningService","checkEditPermission"],"duration":11,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService checkEditPermission should allow free edit for personal tasks (no project)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow free edit for personal tasks (no project)"},{"ancestorTitles":["PlanningService","checkEditPermission"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService checkEditPermission should require approval for strategic projects (non-admin)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should require approval for strategic projects (non-admin)"},{"ancestorTitles":["PlanningService","checkEditPermission"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService checkEditPermission should bypass approval for Admin on strategic projects","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should bypass approval for Admin on strategic projects"},{"ancestorTitles":["PlanningService","checkEditPermission"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService checkEditPermission should allow free edit for operative projects","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow free edit for operative projects"},{"ancestorTitles":["PlanningService","checkEditPermission"],"duration":33,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService checkEditPermission should throw NotFoundException for non-existent task","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw NotFoundException for non-existent task"},{"ancestorTitles":["PlanningService","solicitarCambio"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService solicitarCambio should create a change request","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should create a change request"},{"ancestorTitles":["PlanningService","solicitarCambio"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService solicitarCambio should throw NotFoundException for non-existent task","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw NotFoundException for non-existent task"},{"ancestorTitles":["PlanningService","solicitarCambio"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService solicitarCambio should handle empty previous value","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle empty previous value"},{"ancestorTitles":["PlanningService","getSolicitudesPendientes"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService getSolicitudesPendientes should return pending requests","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return pending requests"},{"ancestorTitles":["PlanningService","getSolicitudesPendientes"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService getSolicitudesPendientes should return empty array when no pending requests","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return empty array when no pending requests"},{"ancestorTitles":["PlanningService","resolverSolicitud"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService resolverSolicitud should approve a request and apply changes","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should approve a request and apply changes"},{"ancestorTitles":["PlanningService","resolverSolicitud"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService resolverSolicitud should reject a request without applying changes","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should reject a request without applying changes"},{"ancestorTitles":["PlanningService","resolverSolicitud"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService resolverSolicitud should throw NotFoundException for non-existent request","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw NotFoundException for non-existent request"},{"ancestorTitles":["PlanningService","resolverSolicitud"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService resolverSolicitud should throw BadRequestException for already processed request","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw BadRequestException for already processed request"},{"ancestorTitles":["PlanningService","updateTareaOperativa"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService updateTareaOperativa should update operative task and create audit log","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should update operative task and create audit log"},{"ancestorTitles":["PlanningService","updateTareaOperativa"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"PlanningService updateTareaOperativa should throw ForbiddenException for strategic tasks","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ForbiddenException for strategic tasks"}],"endTime":1768315278327,"message":"","name":"D:\\planificacion\\backend\\src\\planning\\planning.service.spec.ts","startTime":1768315272213,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["ReportsService"],"duration":52,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should be defined"},{"ancestorTitles":["ReportsService","getReporteProductividad"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService getReporteProductividad should return productivity data for team","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return productivity data for team"},{"ancestorTitles":["ReportsService","getReporteProductividad"],"duration":17,"failureDetails":[{"matcherResult":{"actual":[{"idUsuario":1,"nombre":"User 1","completadas":10},{"idUsuario":2,"nombre":"User 2","completadas":8}],"expected":[],"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  -  1\u001b[39m\n\u001b[31m+ Received  + 12\u001b[39m\n\n\u001b[32m- Array []\u001b[39m\n\u001b[31m+ Array [\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"completadas\": 10,\u001b[39m\n\u001b[31m+     \"idUsuario\": 1,\u001b[39m\n\u001b[31m+     \"nombre\": \"User 1\",\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"completadas\": 8,\u001b[39m\n\u001b[31m+     \"idUsuario\": 2,\u001b[39m\n\u001b[31m+     \"nombre\": \"User 2\",\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+ ]\u001b[39m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  -  1\u001b[39m\n\u001b[31m+ Received  + 12\u001b[39m\n\n\u001b[32m- Array []\u001b[39m\n\u001b[31m+ Array [\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"completadas\": 10,\u001b[39m\n\u001b[31m+     \"idUsuario\": 1,\u001b[39m\n\u001b[31m+     \"nombre\": \"User 1\",\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"completadas\": 8,\u001b[39m\n\u001b[31m+     \"idUsuario\": 2,\u001b[39m\n\u001b[31m+     \"nombre\": \"User 2\",\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+ ]\u001b[39m\n    at Object.toEqual (D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts:94:28)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"ReportsService getReporteProductividad should handle empty team","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle empty team"},{"ancestorTitles":["ReportsService","getReporteBloqueosTrend"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService getReporteBloqueosTrend should return blockers trend data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return blockers trend data"},{"ancestorTitles":["ReportsService","getReporteBloqueosTrend"],"duration":8,"failureDetails":[{"matcherResult":{"actual":[{"fecha":"2024-01-15","total":5},{"fecha":"2024-01-16","total":3}],"expected":[],"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  -  1\u001b[39m\n\u001b[31m+ Received  + 10\u001b[39m\n\n\u001b[32m- Array []\u001b[39m\n\u001b[31m+ Array [\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"fecha\": \"2024-01-15\",\u001b[39m\n\u001b[31m+     \"total\": 5,\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"fecha\": \"2024-01-16\",\u001b[39m\n\u001b[31m+     \"total\": 3,\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+ ]\u001b[39m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  -  1\u001b[39m\n\u001b[31m+ Received  + 10\u001b[39m\n\n\u001b[32m- Array []\u001b[39m\n\u001b[31m+ Array [\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"fecha\": \"2024-01-15\",\u001b[39m\n\u001b[31m+     \"total\": 5,\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+   Object {\u001b[39m\n\u001b[31m+     \"fecha\": \"2024-01-16\",\u001b[39m\n\u001b[31m+     \"total\": 3,\u001b[39m\n\u001b[31m+   },\u001b[39m\n\u001b[31m+ ]\u001b[39m\n    at Object.toEqual (D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts:118:28)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"ReportsService getReporteBloqueosTrend should handle empty team","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle empty team"},{"ancestorTitles":["ReportsService","getReporteEquipoPerformance"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService getReporteEquipoPerformance should return team performance metrics","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return team performance metrics"},{"ancestorTitles":["ReportsService","getReporteEquipoPerformance"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService getReporteEquipoPerformance should handle empty team","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle empty team"},{"ancestorTitles":["ReportsService","equipoBloqueos"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService equipoBloqueos should return active blockers for team","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return active blockers for team"},{"ancestorTitles":["ReportsService","getWorkload"],"duration":8,"failureDetails":[{"matcherResult":{"actual":false,"expected":true,"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32mtrue\u001b[39m\nReceived: \u001b[31mfalse\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32mtrue\u001b[39m\nReceived: \u001b[31mfalse\u001b[39m\n    at Object.toBe (D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts:175:43)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"ReportsService getWorkload should return workload data for team","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should return workload data for team"},{"ancestorTitles":["ReportsService","gerenciaResumen"],"duration":6,"failureDetails":[{}],"failureMessages":["TypeError: this.dataSource.getRepository is not a function\n    at ReportsService.getRepository [as gerenciaResumen] (D:\\planificacion\\backend\\src\\clarity\\reports.service.ts:205:48)\n    at Object.gerenciaResumen (D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts:190:42)\n    at Promise.then.completed (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"ReportsService gerenciaResumen should return summary for manager","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return summary for manager"},{"ancestorTitles":["ReportsService","getDateRange"],"duration":8,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoHaveProperty\u001b[2m(\u001b[22m\u001b[32mpath\u001b[39m\u001b[2m)\u001b[22m\n\nExpected path: \u001b[32m\"inicio\"\u001b[39m\nReceived path: \u001b[31m[]\u001b[39m\n\nReceived value: \u001b[31m{\"endDate\": 2026-01-13T14:41:18.298Z, \"startDate\": 2025-12-14T14:41:18.298Z}\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoHaveProperty\u001b[2m(\u001b[22m\u001b[32mpath\u001b[39m\u001b[2m)\u001b[22m\n\nExpected path: \u001b[32m\"inicio\"\u001b[39m\nReceived path: \u001b[31m[]\u001b[39m\n\nReceived value: \u001b[31m{\"endDate\": 2026-01-13T14:41:18.298Z, \"startDate\": 2025-12-14T14:41:18.298Z}\u001b[39m\n    at Object.toHaveProperty (D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts:202:28)\n    at Promise.then.completed (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"ReportsService getDateRange should return date range for current month if no params","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return date range for current month if no params"},{"ancestorTitles":["ReportsService","getDateRange"],"duration":5,"failureDetails":[{"matcherResult":{"expected":"2024-06-01","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"2024-06-01\"\u001b[39m\nReceived: \u001b[31mundefined\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"2024-06-01\"\u001b[39m\nReceived: \u001b[31mundefined\u001b[39m\n    at Object.toBe (D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts:209:35)\n    at Promise.then.completed (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"ReportsService getDateRange should return correct date range for specific month and year","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return correct date range for specific month and year"},{"ancestorTitles":["ReportsService","getSubtreeNodeIds"],"duration":5,"failureDetails":[{"matcherResult":{"actual":[],"expected":[1,2,3],"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 5\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Array [\u001b[39m\n\u001b[32m-   1,\u001b[39m\n\u001b[32m-   2,\u001b[39m\n\u001b[32m-   3,\u001b[39m\n\u001b[32m- ]\u001b[39m\n\u001b[31m+ Array []\u001b[39m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 5\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[32m- Array [\u001b[39m\n\u001b[32m-   1,\u001b[39m\n\u001b[32m-   2,\u001b[39m\n\u001b[32m-   3,\u001b[39m\n\u001b[32m- ]\u001b[39m\n\u001b[31m+ Array []\u001b[39m\n    at Object.toEqual (D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts:224:28)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"ReportsService getSubtreeNodeIds should return node ids from hierarchy","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return node ids from hierarchy"},{"ancestorTitles":["ReportsService","getSubtreeNodeIds"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService getSubtreeNodeIds should return empty array if no nodes found","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return empty array if no nodes found"},{"ancestorTitles":["ReportsService","getSubtreeUserIds"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"ReportsService getSubtreeUserIds should return user ids from team hierarchy","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return user ids from team hierarchy"}],"endTime":1768315278403,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mReportsService › getReporteProductividad › should handle empty team\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  -  1\u001b[39m\n    \u001b[31m+ Received  + 12\u001b[39m\n\n    \u001b[32m- Array []\u001b[39m\n    \u001b[31m+ Array [\u001b[39m\n    \u001b[31m+   Object {\u001b[39m\n    \u001b[31m+     \"completadas\": 10,\u001b[39m\n    \u001b[31m+     \"idUsuario\": 1,\u001b[39m\n    \u001b[31m+     \"nombre\": \"User 1\",\u001b[39m\n    \u001b[31m+   },\u001b[39m\n    \u001b[31m+   Object {\u001b[39m\n    \u001b[31m+     \"completadas\": 8,\u001b[39m\n    \u001b[31m+     \"idUsuario\": 2,\u001b[39m\n    \u001b[31m+     \"nombre\": \"User 2\",\u001b[39m\n    \u001b[31m+   },\u001b[39m\n    \u001b[31m+ ]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 92 |\u001b[39m             \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m service\u001b[33m.\u001b[39mgetReporteProductividad(\u001b[35m1\u001b[39m\u001b[33m,\u001b[39m {})\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 93 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 94 |\u001b[39m             expect(result)\u001b[33m.\u001b[39mtoEqual([])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 95 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 96 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 97 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/reports.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:94:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mReportsService › getReporteBloqueosTrend › should handle empty team\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  -  1\u001b[39m\n    \u001b[31m+ Received  + 10\u001b[39m\n\n    \u001b[32m- Array []\u001b[39m\n    \u001b[31m+ Array [\u001b[39m\n    \u001b[31m+   Object {\u001b[39m\n    \u001b[31m+     \"fecha\": \"2024-01-15\",\u001b[39m\n    \u001b[31m+     \"total\": 5,\u001b[39m\n    \u001b[31m+   },\u001b[39m\n    \u001b[31m+   Object {\u001b[39m\n    \u001b[31m+     \"fecha\": \"2024-01-16\",\u001b[39m\n    \u001b[31m+     \"total\": 3,\u001b[39m\n    \u001b[31m+   },\u001b[39m\n    \u001b[31m+ ]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 116 |\u001b[39m             \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m service\u001b[33m.\u001b[39mgetReporteBloqueosTrend(\u001b[35m1\u001b[39m\u001b[33m,\u001b[39m {})\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 117 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 118 |\u001b[39m             expect(result)\u001b[33m.\u001b[39mtoEqual([])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 119 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 120 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 121 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/reports.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:118:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mReportsService › getWorkload › should return workload data for team\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32mtrue\u001b[39m\n    Received: \u001b[31mfalse\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 173 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 174 |\u001b[39m             expect(result)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 175 |\u001b[39m             expect(\u001b[33mArray\u001b[39m\u001b[33m.\u001b[39misArray(result))\u001b[33m.\u001b[39mtoBe(\u001b[36mtrue\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                           \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 176 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 177 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 178 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/reports.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:175:43)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mReportsService › gerenciaResumen › should return summary for manager\u001b[39m\u001b[22m\n\n    TypeError: this.dataSource.getRepository is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 203 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 204 |\u001b[39m     \u001b[36masync\u001b[39m gerenciaResumen(idUsuario\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m fecha\u001b[33m:\u001b[39m string) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 205 |\u001b[39m         \u001b[36mconst\u001b[39m misNodos \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mdataSource\u001b[33m.\u001b[39mgetRepository(\u001b[33mUsuarioOrganizacion\u001b[39m)\u001b[33m.\u001b[39mfind({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 206 |\u001b[39m             where\u001b[33m:\u001b[39m { idUsuario\u001b[33m,\u001b[39m rol\u001b[33m:\u001b[39m \u001b[33mIn\u001b[39m([\u001b[32m'Gerente'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'Director'\u001b[39m]) }\u001b[22m\n\u001b[2m     \u001b[90m 207 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 208 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat ReportsService.getRepository [as gerenciaResumen] (\u001b[22m\u001b[2mclarity/reports.service.ts\u001b[2m:205:48)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.gerenciaResumen (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/reports.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:190:42)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mReportsService › getDateRange › should return date range for current month if no params\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoHaveProperty\u001b[2m(\u001b[22m\u001b[32mpath\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected path: \u001b[32m\"inicio\"\u001b[39m\n    Received path: \u001b[31m[]\u001b[39m\n\n    Received value: \u001b[31m{\"endDate\": 2026-01-13T14:41:18.298Z, \"startDate\": 2025-12-14T14:41:18.298Z}\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 200 |\u001b[39m             \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m (service \u001b[36mas\u001b[39m any)\u001b[33m.\u001b[39mgetDateRange()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 201 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 202 |\u001b[39m             expect(result)\u001b[33m.\u001b[39mtoHaveProperty(\u001b[32m'inicio'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 203 |\u001b[39m             expect(result)\u001b[33m.\u001b[39mtoHaveProperty(\u001b[32m'fin'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 204 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 205 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveProperty (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/reports.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:202:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mReportsService › getDateRange › should return correct date range for specific month and year\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"2024-06-01\"\u001b[39m\n    Received: \u001b[31mundefined\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 207 |\u001b[39m             \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m (service \u001b[36mas\u001b[39m any)\u001b[33m.\u001b[39mgetDateRange(\u001b[35m6\u001b[39m\u001b[33m,\u001b[39m \u001b[35m2024\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 208 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 209 |\u001b[39m             expect(result\u001b[33m.\u001b[39minicio)\u001b[33m.\u001b[39mtoBe(\u001b[32m'2024-06-01'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 210 |\u001b[39m             expect(result\u001b[33m.\u001b[39mfin)\u001b[33m.\u001b[39mtoBe(\u001b[32m'2024-06-30'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 211 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 212 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBe (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/reports.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:209:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mReportsService › getSubtreeNodeIds › should return node ids from hierarchy\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 5\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[32m- Array [\u001b[39m\n    \u001b[32m-   1,\u001b[39m\n    \u001b[32m-   2,\u001b[39m\n    \u001b[32m-   3,\u001b[39m\n    \u001b[32m- ]\u001b[39m\n    \u001b[31m+ Array []\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 222 |\u001b[39m             \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m (service \u001b[36mas\u001b[39m any)\u001b[33m.\u001b[39mgetSubtreeNodeIds(\u001b[35m1\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 223 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 224 |\u001b[39m             expect(result)\u001b[33m.\u001b[39mtoEqual([\u001b[35m1\u001b[39m\u001b[33m,\u001b[39m \u001b[35m2\u001b[39m\u001b[33m,\u001b[39m \u001b[35m3\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 225 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 226 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 227 |\u001b[39m         it(\u001b[32m'should return empty array if no nodes found'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/reports.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:224:28)\u001b[22m\u001b[2m\u001b[22m\n","name":"D:\\planificacion\\backend\\src\\clarity\\reports.service.spec.ts","startTime":1768315272223,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["AuthService"],"duration":61,"failureDetails":[],"failureMessages":[],"fullName":"AuthService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should be defined"},{"ancestorTitles":["AuthService","validateUser"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"AuthService validateUser should return user when credentials are valid","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should return user when credentials are valid"},{"ancestorTitles":["AuthService","validateUser"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"AuthService validateUser should return null when user does not exist","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return null when user does not exist"},{"ancestorTitles":["AuthService","validateUser"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"AuthService validateUser should return null when password is incorrect","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return null when password is incorrect"},{"ancestorTitles":["AuthService","validateUser"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"AuthService validateUser should return null when user has no credentials","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return null when user has no credentials"},{"ancestorTitles":["AuthService","validateUser"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"AuthService validateUser should return null for inactive user","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return null for inactive user"},{"ancestorTitles":["AuthService","login"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"AuthService login should return tokens and user info on successful login","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return tokens and user info on successful login"},{"ancestorTitles":["AuthService","login"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"AuthService login should generate tokens with correct payload","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should generate tokens with correct payload"},{"ancestorTitles":["AuthService","refreshTokens"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"AuthService refreshTokens should return new tokens when refresh token is valid","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return new tokens when refresh token is valid"},{"ancestorTitles":["AuthService","refreshTokens"],"duration":29,"failureDetails":[],"failureMessages":[],"fullName":"AuthService refreshTokens should throw UnauthorizedException when credentials not found","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw UnauthorizedException when credentials not found"},{"ancestorTitles":["AuthService","refreshTokens"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"AuthService refreshTokens should throw UnauthorizedException when no refresh token stored","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw UnauthorizedException when no refresh token stored"},{"ancestorTitles":["AuthService","refreshTokens"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"AuthService refreshTokens should throw UnauthorizedException when refresh token does not match","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw UnauthorizedException when refresh token does not match"},{"ancestorTitles":["AuthService","refreshTokens"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"AuthService refreshTokens should throw UnauthorizedException when user no longer exists","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw UnauthorizedException when user no longer exists"}],"endTime":1768315278429,"message":"","name":"D:\\planificacion\\backend\\src\\auth\\auth.service.spec.ts","startTime":1768315272198,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["ClarityService"],"duration":40,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should be defined"},{"ancestorTitles":["ClarityService","usuariosListarTodos"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService usuariosListarTodos should list all users with pagination","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should list all users with pagination"},{"ancestorTitles":["ClarityService","usuariosListarTodos"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService usuariosListarTodos should handle empty user list","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle empty user list"},{"ancestorTitles":["ClarityService","usuariosListarTodos"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService usuariosListarTodos should calculate lastPage correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should calculate lastPage correctly"},{"ancestorTitles":["ClarityService","usuarioCambiarRol"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService usuarioCambiarRol should change user role via update","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should change user role via update"},{"ancestorTitles":["ClarityService","logsListar"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService logsListar should return paginated logs","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return paginated logs"},{"ancestorTitles":["ClarityService","crearLog"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService crearLog should create a system log","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create a system log"},{"ancestorTitles":["ClarityService","auditLogsListar"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService auditLogsListar should return audit logs with pagination","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return audit logs with pagination"},{"ancestorTitles":["ClarityService","auditLogsByTask"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService auditLogsByTask should return audit logs for specific task","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return audit logs for specific task"},{"ancestorTitles":["ClarityService","saveAuditLog"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService saveAuditLog should create audit log entry","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create audit log entry"},{"ancestorTitles":["ClarityService","getConfig"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService getConfig should return user config if exists","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return user config if exists"},{"ancestorTitles":["ClarityService","getConfig"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService getConfig should return null if config does not exist","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return null if config does not exist"},{"ancestorTitles":["ClarityService","setConfig"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService setConfig should update existing config","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should update existing config"},{"ancestorTitles":["ClarityService","setConfig"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService setConfig should create new config if not exists","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create new config if not exists"},{"ancestorTitles":["ClarityService","rolesListar"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService rolesListar should return all roles","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return all roles"},{"ancestorTitles":["ClarityService","rolCrear"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService rolCrear should create a new role","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should create a new role"},{"ancestorTitles":["ClarityService","rolCrear"],"duration":39,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService rolCrear should throw BusinessRuleException for duplicate role name","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw BusinessRuleException for duplicate role name"},{"ancestorTitles":["ClarityService","rolActualizar"],"duration":6,"failureDetails":[{"response":{"message":"Rol con ID 1 no encontrado","errorCode":"RESOURCE_NOT_FOUND"},"status":404,"message":"Rol con ID 1 no encontrado","name":"ResourceNotFoundException"}],"failureMessages":["ResourceNotFoundException: Rol con ID 1 no encontrado\n    at ClarityService.rolActualizar (D:\\planificacion\\backend\\src\\clarity\\clarity.service.ts:129:25)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at Object.<anonymous> (D:\\planificacion\\backend\\src\\clarity\\clarity.service.spec.ts:276:13)"],"fullName":"ClarityService rolActualizar should update an existing role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should update an existing role"},{"ancestorTitles":["ClarityService","rolActualizar"],"duration":45,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected constructor: \u001b[32mBusinessRuleException\u001b[39m\nReceived constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\nReceived message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n    \u001b[0m \u001b[90m 127 |\u001b[39m     \u001b[36masync\u001b[39m rolActualizar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m dto\u001b[33m:\u001b[39m \u001b[33mRolActualizarDto\u001b[39m\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n     \u001b[90m 128 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 129 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 130 |\u001b[39m\n     \u001b[90m 131 |\u001b[39m         \u001b[36mif\u001b[39m (dto\u001b[33m.\u001b[39mnombre) {\n     \u001b[90m 132 |\u001b[39m             \u001b[36mconst\u001b[39m existing \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOne({ where\u001b[33m:\u001b[39m { nombre\u001b[33m:\u001b[39m dto\u001b[33m.\u001b[39mnombre } })\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat ClarityService.rolActualizar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:129:25)\u001b[22m\n      \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:287:13)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected constructor: \u001b[32mBusinessRuleException\u001b[39m\nReceived constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\nReceived message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n    \u001b[0m \u001b[90m 127 |\u001b[39m     \u001b[36masync\u001b[39m rolActualizar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m dto\u001b[33m:\u001b[39m \u001b[33mRolActualizarDto\u001b[39m\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n     \u001b[90m 128 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 129 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 130 |\u001b[39m\n     \u001b[90m 131 |\u001b[39m         \u001b[36mif\u001b[39m (dto\u001b[33m.\u001b[39mnombre) {\n     \u001b[90m 132 |\u001b[39m             \u001b[36mconst\u001b[39m existing \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOne({ where\u001b[33m:\u001b[39m { nombre\u001b[33m:\u001b[39m dto\u001b[33m.\u001b[39mnombre } })\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat ClarityService.rolActualizar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:129:25)\u001b[22m\n      \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:287:13)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected constructor: \u001b[32mBusinessRuleException\u001b[39m\nReceived constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\nReceived message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n    \u001b[0m \u001b[90m 127 |\u001b[39m     \u001b[36masync\u001b[39m rolActualizar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m dto\u001b[33m:\u001b[39m \u001b[33mRolActualizarDto\u001b[39m\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n     \u001b[90m 128 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 129 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 130 |\u001b[39m\n     \u001b[90m 131 |\u001b[39m         \u001b[36mif\u001b[39m (dto\u001b[33m.\u001b[39mnombre) {\n     \u001b[90m 132 |\u001b[39m             \u001b[36mconst\u001b[39m existing \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOne({ where\u001b[33m:\u001b[39m { nombre\u001b[33m:\u001b[39m dto\u001b[33m.\u001b[39mnombre } })\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat ClarityService.rolActualizar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:129:25)\u001b[22m\n      \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:287:13)\u001b[22m\n    at Object.toThrow (D:\\planificacion\\backend\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (D:\\planificacion\\backend\\src\\clarity\\clarity.service.spec.ts:288:26)\n    at Promise.then.completed (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"ClarityService rolActualizar should throw BusinessRuleException for system role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should throw BusinessRuleException for system role"},{"ancestorTitles":["ClarityService","rolActualizar"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService rolActualizar should throw ResourceNotFoundException for non-existent role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException for non-existent role"},{"ancestorTitles":["ClarityService","rolEliminar"],"duration":4,"failureDetails":[{"response":{"message":"Rol con ID 3 no encontrado","errorCode":"RESOURCE_NOT_FOUND"},"status":404,"message":"Rol con ID 3 no encontrado","name":"ResourceNotFoundException"}],"failureMessages":["ResourceNotFoundException: Rol con ID 3 no encontrado\n    at ClarityService.rolEliminar (D:\\planificacion\\backend\\src\\clarity\\clarity.service.ts:146:25)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at Object.<anonymous> (D:\\planificacion\\backend\\src\\clarity\\clarity.service.spec.ts:305:13)"],"fullName":"ClarityService rolEliminar should delete a non-system role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should delete a non-system role"},{"ancestorTitles":["ClarityService","rolEliminar"],"duration":13,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected constructor: \u001b[32mBusinessRuleException\u001b[39m\nReceived constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\nReceived message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n    \u001b[0m \u001b[90m 144 |\u001b[39m     \u001b[36masync\u001b[39m rolEliminar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n     \u001b[90m 145 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 146 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 147 |\u001b[39m         \u001b[36mif\u001b[39m (rol\u001b[33m.\u001b[39mesSistema) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mInsufficientPermissionsException\u001b[39m(\u001b[32m'eliminar roles de sistema'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 148 |\u001b[39m\n     \u001b[90m 149 |\u001b[39m         \u001b[36mconst\u001b[39m users \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39muserRepo\u001b[33m.\u001b[39mcount({ where\u001b[33m:\u001b[39m { idRol\u001b[33m:\u001b[39m id } })\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat ClarityService.rolEliminar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:146:25)\u001b[22m\n      \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:315:13)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected constructor: \u001b[32mBusinessRuleException\u001b[39m\nReceived constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\nReceived message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n    \u001b[0m \u001b[90m 144 |\u001b[39m     \u001b[36masync\u001b[39m rolEliminar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n     \u001b[90m 145 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 146 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 147 |\u001b[39m         \u001b[36mif\u001b[39m (rol\u001b[33m.\u001b[39mesSistema) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mInsufficientPermissionsException\u001b[39m(\u001b[32m'eliminar roles de sistema'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 148 |\u001b[39m\n     \u001b[90m 149 |\u001b[39m         \u001b[36mconst\u001b[39m users \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39muserRepo\u001b[33m.\u001b[39mcount({ where\u001b[33m:\u001b[39m { idRol\u001b[33m:\u001b[39m id } })\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat ClarityService.rolEliminar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:146:25)\u001b[22m\n      \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:315:13)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected constructor: \u001b[32mBusinessRuleException\u001b[39m\nReceived constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\nReceived message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n    \u001b[0m \u001b[90m 144 |\u001b[39m     \u001b[36masync\u001b[39m rolEliminar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n     \u001b[90m 145 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 146 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 147 |\u001b[39m         \u001b[36mif\u001b[39m (rol\u001b[33m.\u001b[39mesSistema) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mInsufficientPermissionsException\u001b[39m(\u001b[32m'eliminar roles de sistema'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 148 |\u001b[39m\n     \u001b[90m 149 |\u001b[39m         \u001b[36mconst\u001b[39m users \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39muserRepo\u001b[33m.\u001b[39mcount({ where\u001b[33m:\u001b[39m { idRol\u001b[33m:\u001b[39m id } })\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat ClarityService.rolEliminar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:146:25)\u001b[22m\n      \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:315:13)\u001b[22m\n    at Object.toThrow (D:\\planificacion\\backend\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (D:\\planificacion\\backend\\src\\clarity\\clarity.service.spec.ts:316:26)\n    at Promise.then.completed (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"ClarityService rolEliminar should throw BusinessRuleException for system role deletion","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should throw BusinessRuleException for system role deletion"},{"ancestorTitles":["ClarityService","nodoCrear"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService nodoCrear should create organization node","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should create organization node"},{"ancestorTitles":["ClarityService","usuarioAsignarANodo"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"ClarityService usuarioAsignarANodo should assign user to organization node","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should assign user to organization node"},{"ancestorTitles":["ClarityService","usuarioAsignarANodo"],"duration":6,"failureDetails":[{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"fechaInicio\": \"2024-01-01\", \"idNodo\": 3, \"idRelacion\": 1, \"idUsuario\": 5, \"rol\": \"Miembro\"}\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"fechaInicio\": \"2024-01-01\", \"idNodo\": 3, \"idRelacion\": 1, \"idUsuario\": 5, \"rol\": \"Miembro\"}\u001b[39m\n    at expect (D:\\planificacion\\backend\\node_modules\\expect\\build\\index.js:113:15)\n    at Object.expect (D:\\planificacion\\backend\\src\\clarity\\clarity.service.spec.ts:349:19)\n    at Promise.then.completed (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"ClarityService usuarioAsignarANodo should throw ResourceNotFoundException for non-existent user","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should throw ResourceNotFoundException for non-existent user"},{"ancestorTitles":["ClarityService","usuarioAsignarANodo"],"duration":6,"failureDetails":[{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"fechaInicio\": \"2024-01-01\", \"idNodo\": 3, \"idRelacion\": 1, \"idUsuario\": 5, \"rol\": \"Miembro\"}\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"fechaInicio\": \"2024-01-01\", \"idNodo\": 3, \"idRelacion\": 1, \"idUsuario\": 5, \"rol\": \"Miembro\"}\u001b[39m\n    at expect (D:\\planificacion\\backend\\node_modules\\expect\\build\\index.js:113:15)\n    at Object.expect (D:\\planificacion\\backend\\src\\clarity\\clarity.service.spec.ts:357:19)\n    at Promise.then.completed (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at _runTest (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (D:\\planificacion\\backend\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (D:\\planificacion\\backend\\node_modules\\jest-runner\\build\\testWorker.js:106:12)"],"fullName":"ClarityService usuarioAsignarANodo should throw ResourceNotFoundException for non-existent node","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should throw ResourceNotFoundException for non-existent node"}],"endTime":1768315278446,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mClarityService › rolActualizar › should update an existing role\u001b[39m\u001b[22m\n\n    ResourceNotFoundException: Rol con ID 1 no encontrado\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 127 |\u001b[39m     \u001b[36masync\u001b[39m rolActualizar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m dto\u001b[33m:\u001b[39m \u001b[33mRolActualizarDto\u001b[39m\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\u001b[22m\n\u001b[2m     \u001b[90m 128 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 129 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 130 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 131 |\u001b[39m         \u001b[36mif\u001b[39m (dto\u001b[33m.\u001b[39mnombre) {\u001b[22m\n\u001b[2m     \u001b[90m 132 |\u001b[39m             \u001b[36mconst\u001b[39m existing \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOne({ where\u001b[33m:\u001b[39m { nombre\u001b[33m:\u001b[39m dto\u001b[33m.\u001b[39mnombre } })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat ClarityService.rolActualizar (\u001b[22m\u001b[2mclarity/clarity.service.ts\u001b[2m:129:25)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/clarity.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:276:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mClarityService › rolActualizar › should throw BusinessRuleException for system role\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected constructor: \u001b[32mBusinessRuleException\u001b[39m\n    Received constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\n    Received message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n        \u001b[0m \u001b[90m 127 |\u001b[39m     \u001b[36masync\u001b[39m rolActualizar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m dto\u001b[33m:\u001b[39m \u001b[33mRolActualizarDto\u001b[39m\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n         \u001b[90m 128 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 129 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 130 |\u001b[39m\n         \u001b[90m 131 |\u001b[39m         \u001b[36mif\u001b[39m (dto\u001b[33m.\u001b[39mnombre) {\n         \u001b[90m 132 |\u001b[39m             \u001b[36mconst\u001b[39m existing \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOne({ where\u001b[33m:\u001b[39m { nombre\u001b[33m:\u001b[39m dto\u001b[33m.\u001b[39mnombre } })\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat ClarityService.rolActualizar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:129:25)\u001b[22m\n          \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:287:13)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 286 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 287 |\u001b[39m             \u001b[36mawait\u001b[39m expect(service\u001b[33m.\u001b[39mrolActualizar(\u001b[35m1\u001b[39m\u001b[33m,\u001b[39m { nombre\u001b[33m:\u001b[39m \u001b[32m'NewName'\u001b[39m } \u001b[36mas\u001b[39m any\u001b[33m,\u001b[39m \u001b[35m1\u001b[39m))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 288 |\u001b[39m                 \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[33mBusinessRuleException\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 289 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 290 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 291 |\u001b[39m         it(\u001b[32m'should throw ResourceNotFoundException for non-existent role'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m../node_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/clarity.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:288:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mClarityService › rolEliminar › should delete a non-system role\u001b[39m\u001b[22m\n\n    ResourceNotFoundException: Rol con ID 3 no encontrado\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 144 |\u001b[39m     \u001b[36masync\u001b[39m rolEliminar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\u001b[22m\n\u001b[2m     \u001b[90m 145 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 146 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 147 |\u001b[39m         \u001b[36mif\u001b[39m (rol\u001b[33m.\u001b[39mesSistema) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mInsufficientPermissionsException\u001b[39m(\u001b[32m'eliminar roles de sistema'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 148 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 149 |\u001b[39m         \u001b[36mconst\u001b[39m users \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39muserRepo\u001b[33m.\u001b[39mcount({ where\u001b[33m:\u001b[39m { idRol\u001b[33m:\u001b[39m id } })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat ClarityService.rolEliminar (\u001b[22m\u001b[2mclarity/clarity.service.ts\u001b[2m:146:25)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/clarity.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:305:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mClarityService › rolEliminar › should throw BusinessRuleException for system role deletion\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected constructor: \u001b[32mBusinessRuleException\u001b[39m\n    Received constructor: \u001b[31mResourceNotFoundException\u001b[39m\n\n    Received message: \u001b[31m\"Rol con ID 1 no encontrado\"\u001b[39m\n\n        \u001b[0m \u001b[90m 144 |\u001b[39m     \u001b[36masync\u001b[39m rolEliminar(id\u001b[33m:\u001b[39m number\u001b[33m,\u001b[39m idEjecutor\u001b[33m:\u001b[39m number) {\n         \u001b[90m 145 |\u001b[39m         \u001b[36mconst\u001b[39m rol \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39mrolRepo\u001b[33m.\u001b[39mfindOneBy({ idRol\u001b[33m:\u001b[39m id })\u001b[33m;\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 146 |\u001b[39m         \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mrol) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mResourceNotFoundException\u001b[39m(\u001b[32m'Rol'\u001b[39m\u001b[33m,\u001b[39m id)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 147 |\u001b[39m         \u001b[36mif\u001b[39m (rol\u001b[33m.\u001b[39mesSistema) \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mInsufficientPermissionsException\u001b[39m(\u001b[32m'eliminar roles de sistema'\u001b[39m)\u001b[33m;\u001b[39m\n         \u001b[90m 148 |\u001b[39m\n         \u001b[90m 149 |\u001b[39m         \u001b[36mconst\u001b[39m users \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39muserRepo\u001b[33m.\u001b[39mcount({ where\u001b[33m:\u001b[39m { idRol\u001b[33m:\u001b[39m id } })\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat ClarityService.rolEliminar (\u001b[22msrc/clarity/clarity.service.ts\u001b[2m:146:25)\u001b[22m\n          \u001b[2mat Object.<anonymous> (\u001b[22msrc/clarity/clarity.service.spec.ts\u001b[2m:315:13)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 314 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 315 |\u001b[39m             \u001b[36mawait\u001b[39m expect(service\u001b[33m.\u001b[39mrolEliminar(\u001b[35m1\u001b[39m\u001b[33m,\u001b[39m \u001b[35m1\u001b[39m))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 316 |\u001b[39m                 \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[33mBusinessRuleException\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 317 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 318 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 319 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m../node_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/clarity.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:316:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mClarityService › usuarioAsignarANodo › should throw ResourceNotFoundException for non-existent user\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\n    Received promise resolved instead of rejected\n    Resolved to value: \u001b[31m{\"fechaInicio\": \"2024-01-01\", \"idNodo\": 3, \"idRelacion\": 1, \"idUsuario\": 5, \"rol\": \"Miembro\"}\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 347 |\u001b[39m             mockUserRepo\u001b[33m.\u001b[39mfindOneBy\u001b[33m.\u001b[39mmockResolvedValue(\u001b[36mnull\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 348 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 349 |\u001b[39m             \u001b[36mawait\u001b[39m expect(service\u001b[33m.\u001b[39musuarioAsignarANodo({ idUsuario\u001b[33m:\u001b[39m \u001b[35m999\u001b[39m\u001b[33m,\u001b[39m idNodo\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m } \u001b[36mas\u001b[39m any\u001b[33m,\u001b[39m \u001b[35m1\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 350 |\u001b[39m                 \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[33mResourceNotFoundException\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 351 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 352 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat expect (\u001b[22m\u001b[2m../node_modules/expect/build/index.js\u001b[2m:113:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.expect (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/clarity.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:349:19)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mClarityService › usuarioAsignarANodo › should throw ResourceNotFoundException for non-existent node\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\n    Received promise resolved instead of rejected\n    Resolved to value: \u001b[31m{\"fechaInicio\": \"2024-01-01\", \"idNodo\": 3, \"idRelacion\": 1, \"idUsuario\": 5, \"rol\": \"Miembro\"}\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 355 |\u001b[39m             mockNodoRepo\u001b[33m.\u001b[39mfindOneBy\u001b[33m.\u001b[39mmockResolvedValue(\u001b[36mnull\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 356 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 357 |\u001b[39m             \u001b[36mawait\u001b[39m expect(service\u001b[33m.\u001b[39musuarioAsignarANodo({ idUsuario\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m idNodo\u001b[33m:\u001b[39m \u001b[35m999\u001b[39m } \u001b[36mas\u001b[39m any\u001b[33m,\u001b[39m \u001b[35m1\u001b[39m))\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 358 |\u001b[39m                 \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[33mResourceNotFoundException\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 359 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 360 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat expect (\u001b[22m\u001b[2m../node_modules/expect/build/index.js\u001b[2m:113:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.expect (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/clarity.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:357:19)\u001b[22m\u001b[2m\u001b[22m\n","name":"D:\\planificacion\\backend\\src\\clarity\\clarity.service.spec.ts","startTime":1768315272178,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["TasksService"],"duration":57,"failureDetails":[],"failureMessages":[],"fullName":"TasksService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should be defined"},{"ancestorTitles":["TasksService","tareaCrearRapida"],"duration":13,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaCrearRapida should create a task with default priority Media","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should create a task with default priority Media"},{"ancestorTitles":["TasksService","tareaCrearRapida"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaCrearRapida should use provided priority if specified","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should use provided priority if specified"},{"ancestorTitles":["TasksService","tareaCrearRapida"],"duration":11,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"idAsignadoPor\": 5, \"idCreador\": 5}\u001b[39m\nReceived: \u001b[31m{\"esfuerzo\": \"M\", \"estado\": \"Pendiente\", \"fechaInicioPlanificada\": undefined, \"idCreador\": 5, \"idProyecto\": undefined, \"prioridad\": \"Media\", \"titulo\": \"Test\"}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"idAsignadoPor\": 5, \"idCreador\": 5}\u001b[39m\nReceived: \u001b[31m{\"esfuerzo\": \"M\", \"estado\": \"Pendiente\", \"fechaInicioPlanificada\": undefined, \"idCreador\": 5, \"idProyecto\": undefined, \"prioridad\": \"Media\", \"titulo\": \"Test\"}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (D:\\planificacion\\backend\\src\\clarity\\tasks.service.spec.ts:135:42)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"TasksService tareaCrearRapida should set createdBy user correctly","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should set createdBy user correctly"},{"ancestorTitles":["TasksService","tareaActualizar"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaActualizar should update task when user is creator","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should update task when user is creator"},{"ancestorTitles":["TasksService","tareaActualizar"],"duration":24,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaActualizar should throw ResourceNotFoundException for non-existent task","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException for non-existent task"},{"ancestorTitles":["TasksService","tareaActualizar"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaActualizar should allow admin to update any task","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow admin to update any task"},{"ancestorTitles":["TasksService","tareaAsignarResponsable"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaAsignarResponsable should assign user as responsible for task","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should assign user as responsible for task"},{"ancestorTitles":["TasksService","tareaAsignarResponsable"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaAsignarResponsable should throw ResourceNotFoundException when task does not exist","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException when task does not exist"},{"ancestorTitles":["TasksService","tareaActualizarOrden"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaActualizarOrden should update task order","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should update task order"},{"ancestorTitles":["TasksService","tareaActualizarOrden"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"TasksService tareaActualizarOrden should throw ResourceNotFoundException for non-existent task","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException for non-existent task"},{"ancestorTitles":["TasksService","bloqueoCrear"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"TasksService bloqueoCrear should create a blocker","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create a blocker"},{"ancestorTitles":["TasksService","bloqueoResolver"],"duration":7,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"estado\": \"Resuelto\", \"solucion\": \"Fixed\"}\u001b[39m\nReceived: \u001b[31m{\"estado\": \"Resuelto\", \"fechaResolucion\": 2026-01-13T14:41:18.309Z, \"idBloqueo\": 1, \"idOrigenUsuario\": 5}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"estado\": \"Resuelto\", \"solucion\": \"Fixed\"}\u001b[39m\nReceived: \u001b[31m{\"estado\": \"Resuelto\", \"fechaResolucion\": 2026-01-13T14:41:18.309Z, \"idBloqueo\": 1, \"idOrigenUsuario\": 5}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (D:\\planificacion\\backend\\src\\clarity\\tasks.service.spec.ts:251:42)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)"],"fullName":"TasksService bloqueoResolver should resolve a blocker when user is owner","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should resolve a blocker when user is owner"},{"ancestorTitles":["TasksService","bloqueoResolver"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"TasksService bloqueoResolver should throw ResourceNotFoundException for non-existent blocker","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException for non-existent blocker"},{"ancestorTitles":["TasksService","bloqueoResolver"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"TasksService bloqueoResolver should throw InsufficientPermissionsException when user is not owner","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw InsufficientPermissionsException when user is not owner"},{"ancestorTitles":["TasksService","proyectoCrear"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"TasksService proyectoCrear should create a project","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should create a project"},{"ancestorTitles":["TasksService","proyectoActualizar"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"TasksService proyectoActualizar should update project","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should update project"},{"ancestorTitles":["TasksService","proyectoActualizar"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"TasksService proyectoActualizar should throw ResourceNotFoundException for non-existent project","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException for non-existent project"},{"ancestorTitles":["TasksService","proyectoEliminar"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"TasksService proyectoEliminar should archive project (soft delete)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should archive project (soft delete)"},{"ancestorTitles":["TasksService","proyectoEliminar"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"TasksService proyectoEliminar should throw ResourceNotFoundException for non-existent project","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException for non-existent project"},{"ancestorTitles":["TasksService","proyectoObtener"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"TasksService proyectoObtener should return project with tasks","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return project with tasks"},{"ancestorTitles":["TasksService","proyectoObtener"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"TasksService proyectoObtener should throw ResourceNotFoundException for non-existent project","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw ResourceNotFoundException for non-existent project"},{"ancestorTitles":["TasksService","checkinUpsert"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"TasksService checkinUpsert should create new checkin if none exists","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should create new checkin if none exists"},{"ancestorTitles":["TasksService","checkinUpsert"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"TasksService checkinUpsert should update existing checkin","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should update existing checkin"},{"ancestorTitles":["TasksService","equipoHoy"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"TasksService equipoHoy should handle empty team gracefully","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle empty team gracefully"}],"endTime":1768315278447,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mTasksService › tareaCrearRapida › should set createdBy user correctly\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"idAsignadoPor\": 5, \"idCreador\": 5}\u001b[39m\n    Received: \u001b[31m{\"esfuerzo\": \"M\", \"estado\": \"Pendiente\", \"fechaInicioPlanificada\": undefined, \"idCreador\": 5, \"idProyecto\": undefined, \"prioridad\": \"Media\", \"titulo\": \"Test\"}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 133 |\u001b[39m             \u001b[36mawait\u001b[39m service\u001b[33m.\u001b[39mtareaCrearRapida(dto \u001b[36mas\u001b[39m any)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 134 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 135 |\u001b[39m             expect(mockTareaRepo\u001b[33m.\u001b[39mcreate)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 136 |\u001b[39m                 idCreador\u001b[33m:\u001b[39m \u001b[35m5\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 137 |\u001b[39m                 idAsignadoPor\u001b[33m:\u001b[39m \u001b[35m5\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 138 |\u001b[39m             }))\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/tasks.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:135:42)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mTasksService › bloqueoResolver › should resolve a blocker when user is owner\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"estado\": \"Resuelto\", \"solucion\": \"Fixed\"}\u001b[39m\n    Received: \u001b[31m{\"estado\": \"Resuelto\", \"fechaResolucion\": 2026-01-13T14:41:18.309Z, \"idBloqueo\": 1, \"idOrigenUsuario\": 5}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 249 |\u001b[39m             \u001b[36mawait\u001b[39m service\u001b[33m.\u001b[39mbloqueoResolver(\u001b[35m1\u001b[39m\u001b[33m,\u001b[39m { solucion\u001b[33m:\u001b[39m \u001b[32m'Fixed'\u001b[39m } \u001b[36mas\u001b[39m any\u001b[33m,\u001b[39m \u001b[35m5\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 250 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 251 |\u001b[39m             expect(mockBloqueoRepo\u001b[33m.\u001b[39msave)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 252 |\u001b[39m                 estado\u001b[33m:\u001b[39m \u001b[32m'Resuelto'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 253 |\u001b[39m                 solucion\u001b[33m:\u001b[39m \u001b[32m'Fixed'\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 254 |\u001b[39m             }))\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mclarity/tasks.service.spec.ts\u001b[39m\u001b[0m\u001b[2m:251:42)\u001b[22m\u001b[2m\u001b[22m\n","name":"D:\\planificacion\\backend\\src\\clarity\\tasks.service.spec.ts","startTime":1768315272188,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["AuthController"],"duration":23,"failureDetails":[],"failureMessages":[],"fullName":"AuthController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should be defined"},{"ancestorTitles":["AuthController","login"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"AuthController login should return tokens on valid credentials","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return tokens on valid credentials"},{"ancestorTitles":["AuthController","login"],"duration":23,"failureDetails":[],"failureMessages":[],"fullName":"AuthController login should throw InvalidCredentialsException on invalid credentials","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw InvalidCredentialsException on invalid credentials"}],"endTime":1768315279030,"message":"","name":"D:\\planificacion\\backend\\src\\auth\\auth.controller.spec.ts","startTime":1768315272201,"status":"passed","summary":""}],"wasInterrupted":false}
