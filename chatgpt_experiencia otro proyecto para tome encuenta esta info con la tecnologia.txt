# MASTER TECHNICAL EXPERIENCE: ECOSISTEMA MOMENTUS
# Gu√≠a Definitiva de Arquitectura, Configuraci√≥n y Estabilidad
# Fecha: 10 de Febrero de 2026

Este documento centraliza la inteligencia t√©cnica de los tres proyectos principales para garantizar que el desarrollo futuro sea √°gil, escalable y libre de errores de configuraci√≥n ya superados.

---

## üèóÔ∏è 1. BACKEND: NESTJS FASTIFY ENGINE
El coraz√≥n del sistema, dise√±ado para alto rendimiento y seguridad.

### A. Configuraci√≥n de Motor (Fastify)
*   **Engine**: Se utiliza `FastifyAdapter` en lugar de Express. Es hasta 2x m√°s r√°pido en el manejo de peticiones JSON.
*   **L√≠mites de Carga**: Configurado `bodyLimit: 10MB` para permitir la subida de documentos y reportes pesados.
*   **CORS**: Habilitado din√°micamente para permitir peticiones tanto de la PWA (Web) como de la App (M√≥vil).

### B. Librer√≠as y Herramientas Cr√≠ticas
*   `mssql`: Driver oficial para conexi√≥n directa y segura con SQL Server.
*   `nest-winston` & `winston-daily-rotate-file`: Sistema de logs profesional que rota archivos diariamente para auditor√≠a.
*   `@nestjs/swagger`: Documentaci√≥n viva disponible en `/api/docs`.
*   `class-validator` & `class-transformer`: Garantizan que NING√öN dato mal formado entre al sistema (Global Validation Pipes).

### C. Reglas de Negocio
*   **Prefix**: Todos los endpoints inician con `/api`.
*   **Errores**: Uso de `GlobalExceptionFilter` para que cualquier error devuelva un JSON estandarizado, evitando que la app m√≥vil se cierre por errores inesperados.

---

## ‚öõÔ∏è 2. WEB PWA: REACT INTELLIGENT FRONTEND
La plataforma de gesti√≥n administrativa con capacidades de App.

### A. Tecnolog√≠as de Visualizaci√≥n y Estado
*   **TanStack Query (React Query)**: El "cerebro" de la sincronizaci√≥n. Maneja cach√© autom√°tico, reintentos y carga optimizada de datos.
*   **Vite**: Motor de compilaci√≥n ultra-r√°pido para una experiencia de desarrollo instant√°nea.
*   **Framer Motion**: Librer√≠a de animaciones utilizada para las transiciones suaves y los efectos "Premium" de la interfaz.

### B. Capacidades H√≠bridas (Capacitor)
*   **@capacitor/core & android**: El proyecto est√° listo para ser convertido en una App nativa de Android desde el mismo c√≥digo de React si fuera necesario.
*   **Vite PWA Plugin**: Permite que la web se instale en tel√©fonos y funcione (en parte) offline.

### C. Estilos y Componentes
*   **Tailwind CSS**: Utilizado para un dise√±o "Utility-First" que permite cambios visuales r√°pidos.
*   **Lucide React**: Set de iconos modernos y consistentes.

---

## üì± 3. M√ìVIL: FLUTTER NATIVE EXPERIENCE
La herramienta de ejecuci√≥n r√°pida y movilidad.

### A. Configuraci√≥n de Sistema (El "Secreto" del Build)
*   **Java 17**: Requisito obligatorio para la compatibilidad con los plugins actuales de Android.
*   **Kotlin DSL (`.gradle.kts`)**: Se utiliza este formato moderno para definir el build, lo que evita errores de sintaxis en proyectos grandes.
*   **minSdkVersion 21**: Compatibilidad amplia garantizando funciones de seguridad modernas.

### B. Librer√≠as Ganadoras (Winning Stack)
*   `dio`: Cliente HTTP con **Interceptores de Seguridad**. Maneja el "Silent Token Refresh" autom√°ticamente.
*   `provider`: Gesti√≥n de estado ligera y predecible.
*   `flutter_secure_storage`: Almacenamiento cifrado de credenciales (nunca guardar passwords en texto plano).
*   `sqflite`: Base de datos local para el funcionamiento offline de la agenda.

### C. Implementaciones de L√≥gica Clave
*   **MomentusTheme**: Centralizaci√≥n de colores (`Slate 900`, `Corporate Red`), tipograf√≠a `Inter` y radios de bordes.
*   **Auto-Asignaci√≥n**: L√≥gica frontend que inyecta autom√°ticamente el ID del usuario actual si no se selecciona responsable al crear tareas.
*   **Agenda Multi-Foco**: Capacidad de enviar m√∫ltiples IDs para el check-in diario, rompiendo la limitaci√≥n de "una sola tarea".

---

## üõ°Ô∏è 4. CONFIGURACI√ìN DE DESPLIEGUE (SECURITY & OPS)

### A. Gesti√≥n de IP y Dominios
*   **Environment**: La App m√≥vil usa `String.fromEnvironment('API_BASE_URL')`. 
*   **Recomendaci√≥n**: Para producci√≥n, nunca exponer IPs en documentos p√∫blicos. El sistema est√° configurado para usar nombres de dominio o placeholders tipo `<YOUR_PRODUCTION_DOMAIN>`.

### B. Metodolog√≠a de Publicaci√≥n
1.  **Backend**: `npm run build` -> `dist/main.js`.
2.  **Web**: `npm run build` -> carpeta `dist/` (servida por Fastify o Nginx).
3.  **M√≥vil**: `flutter build apk --release --no-tree-shake-icons`.

---

**Este documento es el plano maestro del sistema Momentus. Cualquier nuevo integrante o asistente de IA debe leerlo para entender c√≥mo funciona la maquinaria sin repetir errores del pasado.**
